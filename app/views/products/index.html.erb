<% if @products.count > 0 %>
  <%= render @products %>
<% else %>
  <h2>No Products</h2>
<% end %>
<script type="text/javascript">
  $(function() {
    $(".js-more").on("click", function(){
      const button = $(this);
      const id = button.data("id");
      const state = button.data("toggle-state");
      if (state === "closed") {
        $.get(`/products/${id}/description`, function (data){
          $(`#prod-${id}-description`)[0].innerHTML = data;
        });
        $.get(`/products/${id}/inventory`, function (data){
          $(`#prod-${id}-inventory`).css("display","block");
          if (data === "true") {
            $(`#prod-${id}-inventory`)[0].innerHTML = "Available";
          }
          else {
            $(`#prod-${id}-inventory`)[0].innerHTML = "Sold Out";
          }
        });
        button.data("toggle-state", "open");
      }
      else {
        $.get(`/products/${id}/truncated-description`, function(truncatedDescripton) {
          $(`#prod-${id}-description`)[0].innerHTML = truncatedDescripton;
        });
        $(`#prod-${id}-inventory`).css("display","none");
        $(`#prod-${id}-inventory`)[0].innerHTML = "";
        button.data("toggle-state", "closed");
      }
    });
  });
</script>
